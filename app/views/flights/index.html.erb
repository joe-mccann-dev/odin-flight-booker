<h1>Flight Booker</h1>

<!-- dropdowns to search for a flights -->
<section class="section">

  <% if @available_flights.empty? %>

    <h3>Search for a flight below</h3>
    
    <%= form_with(url: flights_path, method: :get) do |form| %>
      <span>FROM </span><%=   form.select(:origin_id, Airport.options_for_select, selected: params[:origin_id]) %>
      <span>TO </span><%=     form.select(:destination_id, Airport.options_for_select, selected: params[:destination_id]) %>
      <span>DEPARTS</span><%= form.select(:departure_time, Flight.options_for_select, selected: params[:departure_time]) %>
      <span>Passengers</span><%= form.select(:tickets, (1..4), selected: params[:tickets]) %>
      
      <%= form.submit "Find Flights", name: nil %>

  <% end %>

<% end %>
  <!-- flight search results -->
    <div>
      <% if @available_flights.any? %>
        <p>
          Flights for <%= long_date_format %>:
        </p>
        <p>
          From: <%= show_selected_airport(params[:origin_id]) %> 
        </p>
        <p>
          To: <%= show_selected_airport(params[:destination_id]) %>
        </p>
        <ul>
          <% @available_flights.each do |flight| %>
            <li>
              <%= flight.airline %><span> Flight #<%= flight.flight_number %></span>
              Departs: <%= short_time_format(flight) %>
              Duration: <%= duration_formatted(flight) %>
              <%= button_to "Book Flight",
                                  new_booking_path,
                                  method: :get,
                                  params: { flight_id: flight.id,
                                            tickets:   params[:tickets]} %>
            </li>
          <% end %>
        </ul>
      <% end %>
    </div>
  <div>
    <p>
      Already booked a flight? Enter your confirmation number to view booking details.
    </p>


    <%= form_tag bookings_path, method: :get do %>
      <p>
        <%= label_tag(:search, "confirmation number") %>
        <%= text_field_tag(:search, params[:search], required: true) %>
        <%= submit_tag "Search", name: nil %>
      </p>
    <% end %>
  </div>
</section>


